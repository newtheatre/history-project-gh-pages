{"version":3,"sources":["AnimatedScroll.coffee","LazyImage.coffee","PeopleGrid.coffee","PeopleSearch.coffee","ProdShotsGallery.coffee","RelativeTime.coffee","archive_sort.coffee","collect.coffee","globals.coffee","keyboard.coffee","lightbox.coffee","report.coffee","search.coffee","app.js","header.coffee","lettering.coffee"],"names":["AnimatedScroll","scrollToAnimated","LazyController","LazyImage","PeopleGrid","PeopleResult","PeopleResults","PeopleSearch","ProdShotsGallery","RelativeTime","ARCHIVE_SORT_LIST","SORT_DROPDOWN","sort_items","PEOPLE_FEED","TEMPLATE_DATA","collectBindEvents","collectPersonFormSetup","disableCollectForm","enableCollectForm","debounce","delay","getUrlParameter","isMobile","bindKeys","Lightbox","LightboxGallery","ReportModel","disableReportForm","enableReportForm","freezeScrolling","frozenScrollTop","reportThanks","unfreezeScrolling","INDEX_URL","REVERSE_INDEX_URL","SearchResultView","configureWindow","doSearch","index","indexReady","loadIndex","reverse_index","[object Object]","scrollEnd","scrollDuration","this","step","bind","scrollStart","window","scrollY","scrollStep","Math","PI","cosParameter","scrollCount","firstTs","requestAnimationFrame","ts","animationTime","scrollMargin","cos","scrollTo","pos","duration","go","LAZY_MARGIN","opts","load","update","imgEl","imgSrc","dataset","src","imgSrcSet","srcset","lastScroll","getBoundingClientRect","top","innerHeight","call","document","addEventListener","i","lazyImageEl","lazyImageEls","len","results","querySelectorAll","length","push","gridEl","scrollerEl","gridScrollEls","gridActiveEl","windowPos","currentEl","enabled","timestamp","ePosCurrent","el","found","lastEl","ref","setCurrent","old_active","sort","sortLabel","querySelector","classList","remove","add","peopleGridEl","peopleScrollerEl","destructor","prodShotsGallery","FIELDS","PS_BODY_PUSH_CLASS","PS_FILTER_FIXED_CLASS","PS_FILTER_FIXED_TOP","PS_MORE_TOGGLE_CLASS","PS_TOGGLE_TOGGLE_CLASS","SEARCH_DATA_URL","SEARCH_INDEX_URL","SEARCH_WORKER_URL","onSearch","onMessage","toggleMore","psFilterEl","psMoreEl","psMoreToggleEl","psBodyEl","psResults","psResultsEl","footerEl","moreIsOpen","scrollIsFixed","searchWorker","Worker","postMessage","cmd","indexUrl","dataUrl","bindSearchFields","psFilterElOffsetTop","$","offset","psFilterHeight","offsetHeight","elem","field","results1","searchFields","Array","getElementById","indexOf","query_terms","value","replace","join","q","searchTerm","query","clear","e","data","attr","render","toggle","filterFooterDistance","top_limit","style","paddingTop","height","psEmptyTemplate","_","template","textContent","psIntro","parentNode","removeChild","hasChildNodes","lastChild","pr","result","innerHTML","appendChild","TEMPLATE_RESULT","node","createElement","html","getTemplate","item","psBody","psFilter","peopleSearch","toggleClick","openGallery","closeGallery","computeControlStickyness","elemContainer","toggleButton","showLabel","hideLabel","fadeOverlay","gallery","galleryInner","galleryOpen","controls","lazyImages","lazyComplete","preLazyLoad","limitedGallery","display","iKey","maxImages","limited","full","lazyLoad","lazySrc","elems","ev","preventDefault","blur","maxHeight","scrollHeight","lazyLoads","offsetTop","controlsHeight","galleryTop","viewportBottom","paddingBottom","prototype","prodShotsGalleryElem","moment","date","startOf","fromNow","format","relTimeEl","relTimeEls","container","sort_key","sorted_items","children","a_elem","b_elem","a","a_alpha","b","b_alpha","toLowerCase","change","val","closest","toggleClass","checked","submit","form_data","form_dict","message","serializeArray","forEach","x","title","name","page_url","url","save","success","Turbolinks","visit","error","career_choices","career_choices_formatted","career_choices_yaml","form_data_computed","contact_allowed_yn","contact_allowed_tf","each","path","get","j","len1","ref1","show","addClass","graduated","course","bio","shows","hide","append","committees","removeClass","hasClass","GITHUB_ISSUES_USER","GITHUB_ISSUES_REPO","ms","func","setTimeout","match","RegExp","exec","location","search","decodeURIComponent","fn","timeout","args","ctx","slice","arguments","clearTimeout","apply","css","im","click","focus","Mousetrap","jekyll_page_previous","disable_keyboard_nav","jekyll_page_next","localStorage","debug_mode","jekyll_page_up","lettering","galleryEm","imageClick","deleteLightbox","galleryLinks","srcElement","getLinkIndex","parentElement","lightbox","currentLightbox","lightboxGallery","nextImage","prevImage","imageLoaded","videoLoaded","close","addElement","changeImage","unbind","scrollTop","body","position","closeEl","nextEl","prevEl","lb","loadSpinnerEl","contentEl","imageEl","videoEl","target","removeEventListener","type","callee","setupImage","href","setupVideo","console","group","groups","lbs","buildJSON","JSON","stringify","FORM_URL","reportModelData","ajax","textStatus","jqXHR","status","alert","errorThrown","sView","urlQ","renderBlank","keyup","Object","time","lunr","Index","timeEnd","lunr_results","RENDER_TO","TEMPLATE_EMPTY","renderResults","renderEmpty","results_html","singleTemplate","getSingleTemplate"],"mappings":"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","file":"app.js","sourcesContent":["class AnimatedScroll\n  constructor: (scrollEnd, scrollDuration) ->\n    @scrollStart = window.scrollY\n    @scrollStep = Math.PI / scrollDuration\n    @cosParameter = (@scrollStart - scrollEnd) / 2\n\n    @scrollEnd = scrollEnd\n    @scrollDuration = scrollDuration\n\n    @scrollCount = 0\n\n    @firstTs = null\n\n  go: ->\n    requestAnimationFrame(@step)\n\n  step: (ts) =>\n    if not @firstTs\n      @firstTs = ts\n\n    animationTime = ts - @firstTs\n\n    if animationTime <= @scrollDuration\n      requestAnimationFrame(@step)\n      scrollMargin = @cosParameter - @cosParameter * Math.cos( animationTime * @scrollStep )\n      window.scrollTo(0, @scrollStart - scrollMargin)\n    else\n      window.scrollTo(0, @scrollEnd)\n\nscrollToAnimated = (pos, duration) ->\n  as = new AnimatedScroll(pos, duration)\n  as.go()\n","# LazyImage: Lazy image loading\n\nclass LazyImage\n  LAZY_CLASS = 'lazy-image'\n  # Viewport plus this margin to trigger load\n  LAZY_MARGIN = 660\n  constructor: (opts) ->\n    @imgEl = opts.imgEl\n    @imgSrc = @imgEl.dataset.src\n    @imgSrcSet = @imgEl.dataset.srcset\n\n    window.requestAnimationFrame(@update)\n    lastScroll = 0\n\n  load: =>\n    # Replace src with actual image src\n    @imgEl.src = @imgSrc\n    @imgEl.srcset = @imgSrcSet\n\n  update: =>\n    if (window.scrollY != @lastScroll) and (\n      @imgEl.getBoundingClientRect().top < (window.innerHeight + LAZY_MARGIN) )\n      @load()\n    else\n      window.requestAnimationFrame(@update)\n      @lastScroll = window.scrollY\n\nclass LazyController\n\ndocument.addEventListener 'turbolinks:load', ->\n  lazyImageEls = document.querySelectorAll('[data-src]')\n  for lazyImageEl in lazyImageEls\n    new LazyImage\n      imgEl: lazyImageEl\n\n# Unsure about destructor, we do not store references to old lazyimages and once\n# the elemnts they pertain to are removed from the DOM they should* be garbage\n# collected.\n","class PeopleGrid\n  constructor: (opts) ->\n    @gridEl = opts.gridEl\n    @scrollerEl = opts.scrollerEl\n    @gridScrollEls = @gridEl.querySelectorAll('.scroll-detect')\n    @gridActiveEl = null\n    @windowPos = -1 # Make run on pageload\n\n    @currentEl = null\n\n    @enabled = true\n\n    window.requestAnimationFrame(@update)\n\n  update: (timestamp) =>\n    # Only run if scroll has occurred\n    if @windowPos == window.scrollY\n      window.requestAnimationFrame(@update) if @enabled\n      @windowPos = window.scrollY\n      return 0\n    else\n      @windowPos = window.scrollY\n\n    lastEl = @gridScrollEls[0]\n    for el in @gridScrollEls\n      ePosCurrent = el.getBoundingClientRect().top\n\n      if ePosCurrent > 60\n        # The previous element is the current element\n        @setCurrent(lastEl) if @currentEl isnt lastEl\n        found = true\n        break\n\n      lastEl = el\n\n    # Selection of last element\n    unless found\n      if ePosCurrent < 60\n        @setCurrent(lastEl) if @currentEl isnt lastEl\n\n    window.requestAnimationFrame(@update) if @enabled\n\n  setCurrent: (el) ->\n    # Get sort data (A, B, C, &c)\n    sort = el.dataset.sortLabel\n    # Remove old active class\n    old_active = @scrollerEl.querySelector('.active')\n    old_active.classList.remove('active') if old_active\n    # Add new active class\n    new_active = @scrollerEl.querySelector(\"[data-sort='#{sort}']\")\n    new_active.classList.add('active')\n    # Save current el\n    @currentEl = el\n\n  destructor: ->\n    @enabled = false\n\ndocument.addEventListener 'turbolinks:load', ->\n  # Tear down existing\n  if window.peopleGridEl\n    window.peopleGridEl.destructor()\n    delete window.peopleGridEl\n\n  # Create\n  peopleGridEl = document.querySelector('#pg')\n  peopleScrollerEl = document.querySelector('#pgScroller')\n  if peopleGridEl\n    window.prodShotsGallery = new PeopleGrid\n      gridEl: peopleGridEl\n      scrollerEl: peopleScrollerEl\n","class PeopleSearch\n  SEARCH_WORKER_URL = '/js/search_worker.js'\n  SEARCH_INDEX_URL = '/feeds/people_index.json'\n  SEARCH_DATA_URL = '/feeds/people.json'\n  FIELDS = [\n    ['people-filter-name', '']\n    ['people-filter-graduated', 'graduated']\n    ['people-filter-career', 'career']\n    ['people-filter-course', 'course']\n    ['people-filter-award', 'award']\n    ['people-filter-srole', 'srole']\n    ['people-filter-crole', 'crole']\n  ]\n\n  PS_FILTER_FIXED_TOP = 27\n  PS_FILTER_FIXED_CLASS = 'people-index__filters--fixed'\n  PS_MORE_TOGGLE_CLASS = 'people-index__filters__more--open'\n  PS_TOGGLE_TOGGLE_CLASS = 'people-index__filters__toggle--open'\n  PS_BODY_PUSH_CLASS = 'people-index--push'\n\n  constructor: (opts) ->\n    @enabled = true\n\n    @psFilterEl = opts.psFilterEl\n    @psMoreEl = @psFilterEl.querySelector('#psMore')\n    @psMoreToggleEl = @psFilterEl.querySelector('#psMoreToggle')\n    @psBodyEl = opts.psBodyEl\n    @psResults = new PeopleResults\n      psResultsEl: opts.psResultsEl\n    @footerEl = document.querySelector('.site-footer')\n\n    @moreIsOpen = false\n    @scrollIsFixed = false\n\n    @searchWorker = new Worker(SEARCH_WORKER_URL)\n    @searchWorker.postMessage\n      cmd: 'init'\n      indexUrl: SEARCH_INDEX_URL\n      dataUrl: SEARCH_DATA_URL\n    @searchWorker.addEventListener 'message', @onMessage\n\n    @bindSearchFields()\n\n    @psMoreToggleEl.addEventListener('click', @toggleMore)\n\n    @psFilterElOffsetTop = $(@psFilterEl).offset().top\n    @psFilterHeight = @psFilterEl.offsetHeight\n    window.requestAnimationFrame(@update)\n\n  destructor: ->\n    @searchWorker.postMessage\n      cmd: 'stop'\n    @enabled = false\n\n  bindSearchFields: ->\n    @searchFields = Array()\n    for field in FIELDS\n      elem = document.getElementById(field[0])\n      if FIELDS.indexOf(field) == 0\n        elem.addEventListener 'input', debounce =>\n          @onSearch()\n      else\n        elem.addEventListener('change', @onSearch)\n      @searchFields.push [elem, field[1]]\n\n  searchTerm: ->\n    query_terms = Array()\n    for field in @searchFields\n      if field[1] == '' and field[0].value != \"\"\n        query_terms.push(field[0].value)\n      else if field[0].value != \"\"\n        query_terms.push(\"#{field[1]}:#{field[0].value}\".replace(/ /g, '_'))\n\n    query_terms.join ' '\n\n  onSearch: =>\n    # Event listener for field changes\n    q = @searchTerm()\n\n    if q.length > 0\n      @searchWorker.postMessage\n        cmd: 'search'\n        query: q\n    else\n      @psResults.clear()\n\n  onMessage: (e) =>\n    data = e.data\n    switch (data.cmd)\n      when 'ready'\n        # Search worker is ready\n        $( @searchFields[0][0] ).attr('placeholder','')\n      when 'results'\n        @psResults.render(data.results)\n\n  toggleMore: =>\n    # Open/close the 'more' drawer, applicable to mobile\n    @moreIsOpen = !@moreIsOpen\n    @psMoreEl.classList.toggle(PS_MORE_TOGGLE_CLASS)\n    @psBodyEl.classList.toggle(PS_BODY_PUSH_CLASS) if @scrollIsFixed\n    @psMoreToggleEl.classList.toggle(PS_TOGGLE_TOGGLE_CLASS)\n\n  update: =>\n    # Only run if scroll changed AND not mobile\n    if (@windowPos != window.scrollY)\n      # No top gap on mobile between header and filter box\n      if isMobile()\n        top_limit = @psFilterElOffsetTop\n      else\n        top_limit = @psFilterElOffsetTop - PS_FILTER_FIXED_TOP\n\n      # If beyond this limit, add fixed class, otherwise remove\n      # Toggle action\n      if (window.scrollY > top_limit) and !@scrollIsFixed\n        @scrollIsFixed = true\n        @psFilterEl.classList.add(PS_FILTER_FIXED_CLASS)\n        @psBodyEl.style.paddingTop = \"#{@psFilterHeight + 6}px\" if isMobile()\n        if isMobile() and @moreIsOpen\n          # http://stackoverflow.com/a/16575811/1345360\n          @psBodyEl.classList.add('noTransition')\n          @psBodyEl.classList.add(PS_BODY_PUSH_CLASS)\n          @psBodyEl.offsetHeight\n          @psBodyEl.classList.remove('noTransition')\n      else if !(window.scrollY > top_limit) and @scrollIsFixed\n        @scrollIsFixed = false\n        @psFilterEl.classList.remove(PS_FILTER_FIXED_CLASS)\n        @psBodyEl.style.paddingTop = \"\" if isMobile()\n        if isMobile()\n          # http://stackoverflow.com/a/16575811/1345360\n          @psBodyEl.classList.add('noTransition')\n          @psBodyEl.classList.remove(PS_BODY_PUSH_CLASS)\n          @psBodyEl.offsetHeight\n          @psBodyEl.classList.remove('noTransition')\n\n      # Stop the scroll following when we hit the footer\n      # Continious action\n      footerOffsetTop = $(@footerEl).offset().top - window.scrollY\n      filterFooterDistance = footerOffsetTop - (\n        @psFilterEl.getBoundingClientRect().height + PS_FILTER_FIXED_TOP)\n\n      if (filterFooterDistance < PS_FILTER_FIXED_TOP) and !isMobile()\n        @psFilterEl.style.top = \"#{filterFooterDistance}px\"\n      else\n        @psFilterEl.style.top = \"\"\n\n    @windowPos = window.scrollY\n    window.requestAnimationFrame(@update) if @enabled\n\n\nclass PeopleResults\n  constructor: (opts) ->\n    @psResultsEl = opts.psResultsEl\n    @psEmptyTemplate = _.template(\n      document.getElementById('psResultEmpty').textContent)\n    @psIntro = document.getElementById('psIntro')\n\n  clear: ->\n    if @psIntro?\n      @psIntro.parentNode.removeChild(@psIntro)\n      delete @psIntro\n    while @psResultsEl.hasChildNodes()\n      @psResultsEl.removeChild(@psResultsEl.lastChild)\n\n  render: (results) ->\n    @clear()\n\n    if results.length == 0\n      @psResultsEl.innerHTML = @psEmptyTemplate()\n\n    output = Array()\n    for result in results\n      pr = new PeopleResult(result)\n      @psResultsEl.appendChild pr.render()\n\n\nclass PeopleResult\n  TEMPLATE_RESULT = 'psResultTemplate'\n  constructor: (result) ->\n    @result = result\n    @node = document.createElement('li')\n  getTemplate: ->\n    _.template document.getElementById(TEMPLATE_RESULT).textContent\n  render: ->\n    html = @getTemplate()\n      item: @result\n    @node.innerHTML = html\n    return @node\n\n\ndocument.addEventListener 'turbolinks:load', ->\n  # Tear down existing\n  if window.peopleSearch\n    window.peopleSearch.destructor()\n    delete window.peopleSearch\n\n  # Create\n  psFilter = document.querySelector('#psFilter')\n  psBody = document.querySelector('#psBody')\n  psResults = document.querySelector('#psResults')\n\n  if psFilter and psResults\n    window.peopleSearch = new PeopleSearch\n      psFilterEl: psFilter\n      psBodyEl: psBody\n      psResultsEl: psResults\n","class ProdShotsGallery\n  maxImages:\n    limited: 4\n    full: 12\n\n  constructor: (opts) ->\n    @elemContainer = opts.elemContainer\n\n    @toggleButton = @elemContainer.querySelector('[data-gallery-toggle]')\n    @showLabel = @elemContainer.querySelector('[data-show-label]')\n    @hideLabel = @elemContainer.querySelector('[data-hide-label]')\n    @fadeOverlay = @elemContainer.querySelector('.fade-out-overlay')\n\n    @gallery = @elemContainer.querySelector('.show-photos')\n    @galleryInner = @elemContainer.querySelector('.show-photos__inner')\n\n    @galleryOpen\n\n    @controls = @elemContainer.querySelector('.show-photos-controls')\n\n    # Lazy image loading\n    @lazyImages = @elemContainer.querySelectorAll('.lazy-image')\n    @lazyComplete = false\n    @preLazyLoad()\n\n    # Limited gallery (doesn't open, just forwards to smugmug)\n    @limitedGallery = @elemContainer.querySelector('.gallery-control').style.display == \"none\"\n\n    # Event listeners\n    if not @limitedGallery\n      @toggleButton.addEventListener('click', @toggleClick)\n      @fadeOverlay.addEventListener('click', @toggleClick)\n      window.requestAnimationFrame(@computeControlStickyness)\n\n  preLazyLoad: ->\n    if @limitedGallery\n      pre = @maxImages.limited\n    else\n      pre = @maxImages.full\n\n    for iKey in [0..pre]\n      if @lazyImages[iKey]\n        @lazyLoad(@lazyImages[iKey])\n\n  lazyLoad: (elem) ->\n    if elem.src != elem.dataset.lazySrc\n      elem.src = elem.dataset.lazySrc\n\n  lazyLoads: (elems) ->\n    for elem in elems\n      @lazyLoad(elem)\n    @lazyComplete = true\n\n  toggleClick: (ev) =>\n    ev.preventDefault()\n    @toggleButton.blur()\n\n    if @galleryOpen\n      @closeGallery(ev)\n    else\n      @openGallery(ev)\n\n  openGallery: (ev) =>\n    # Open gallery\n    @galleryInner.classList.add('show-photos__inner--show')\n    @controls.classList.add('show-photos-controls--sticky')\n    @galleryInner.style.maxHeight = \"#{@galleryInner.scrollHeight}px\"\n    @showLabel.style.display = \"none\"\n    @fadeOverlay.style.display = \"none\"\n    @hideLabel.style.display = \"block\"\n    # Lazy load images if needed\n    if not @lazyComplete\n      @lazyLoads(@lazyImages)\n\n    @galleryOpen = true\n\n  closeGallery: (ev) =>\n    # Hide gallery\n    @galleryInner.classList.remove('show-photos__inner--show')\n    @controls.classList.remove('show-photos-controls--sticky')\n    @galleryInner.style.maxHeight = \"\"\n    @showLabel.style.display = \"block\"\n    @fadeOverlay.style.display = \"block\"\n    @hideLabel.style.display = \"none\"\n\n    @galleryOpen = false\n\n    scrollToAnimated(@gallery.offsetTop-200, 160)\n\n  computeControlStickyness: =>\n    # Sticks the controls to bottom when scrolled beneith, hides\n    # when beyond bounds of elemContainer\n    if @galleryOpen\n      viewportBottom = window.scrollY + window.innerHeight\n      galleryTop = @gallery.offsetTop\n      galleryBottom = @gallery.offsetHeight + @gallery.offsetTop\n      controlsHeight = @controls.offsetHeight\n\n      if viewportBottom > (galleryBottom + controlsHeight) or viewportBottom < (galleryTop + controlsHeight)\n        @controls.classList.remove('show-photos-controls--sticky')\n        @elemContainer.style.paddingBottom = \"\"\n      else\n        @controls.classList.add('show-photos-controls--sticky')\n        @elemContainer.style.paddingBottom = \"#{controlsHeight}px\"\n    else\n      @elemContainer.style.paddingBottom = \"\"\n\n    window.requestAnimationFrame(@computeControlStickyness)\n\n\ndocument.addEventListener 'turbolinks:load', ->\n  prodShotsGalleryElem = document.querySelector('#show-prod-shots')\n  if prodShotsGalleryElem\n    window.prodShotsGallery = new ProdShotsGallery\n      elemContainer: prodShotsGalleryElem\n","class RelativeTime\n  constructor: (opts) ->\n    @el = opts.el\n    @render()\n\n  format: ->\n    moment(@el.dataset.date, \"YYYY-MM-DD\").startOf('day').fromNow()\n\n  render: ->\n    @el.innerHTML = @format()\n\ndocument.addEventListener 'turbolinks:load', ->\n  relTimeEls = document.querySelectorAll('[data-date]')\n  for relTimeEl in relTimeEls\n    new RelativeTime\n      el: relTimeEl\n","ARCHIVE_SORT_LIST = \"#archive-sort-list\"\nSORT_DROPDOWN = \"#archive-sort-dropdown\"\n\nsort_items = (container, sort_key) ->\n  # Sort items in container by given sort_key in data\n  # Array.prototype.sort() takes a compare function\n  sorted_items = $(container).children().sort (a_elem, b_elem) ->\n    a = $(a_elem).data(sort_key)\n    b = $(b_elem).data(sort_key)\n    a_alpha = $(a_elem).data(\"alpha\")\n    b_alpha = $(b_elem).data(\"alpha\")\n    if sort_key == \"alpha\"\n      # String comparison is case sensitive\n      a = a.toLowerCase()\n      b = b.toLowerCase()\n      # From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort#Sorting_with_map\n      return +(a > b) || +(a == b) - 1\n    else\n      if b - a != 0\n        # Sort based on non-equal sort ints\n        return b - a\n      else\n        # Sort ints are equal, secondary sort on alpha\n        return +(a_alpha > b_alpha) || +(a_alpha == b_alpha) - 1\n  # Replace containers elements with sorted ones\n  $(container).html(sorted_items)\n\ndocument.addEventListener 'turbolinks:load', ->\n  $(SORT_DROPDOWN).change ->\n    sort_items(ARCHIVE_SORT_LIST, $(this).val())\n\n","collectBindEvents = ->\n  $('input[type=\"checkbox\"]').change ->\n    $(this).closest(\"label\").toggleClass(\"child-checked\", this.checked)\n\n  $(\"#collect-show-form\").submit (e) ->\n    e.preventDefault()\n\n    form_data = $(this).serializeArray()\n    form_dict = {}\n\n    form_data.forEach (x) ->\n      form_dict[x['name']] = x['value']\n\n    message = \"\"\"# 'Tell us about a show' form submission\n\nField | Data\n----- | ----\nTitle | #{form_dict['title']}\nPlaywright | #{form_dict['playwright']}\nDate Start | #{form_dict['date_start_day']} / #{form_dict['date_start_month']} / #{form_dict['date_start_year']}\nDate End | #{form_dict['date_end_day']} / #{form_dict['date_end_month']} / #{form_dict['date_end_year']}\nType | #{form_dict['type']}\nVenue | #{form_dict['venue']}\n\n## Synopsis\n\n#{form_dict['synopsis']}\n\n## Cast\n\n#{form_dict['cast']}\n\n## Crew\n\n#{form_dict['crew']}\n\n## Anything Else\n\n#{form_dict['other']}\n\n## Submitter\n\nField | Data\n----- | ----\nName | #{form_dict['name']}\nGraduated | #{form_dict['graduation']}\n\n## Attempted File Generation\n\n```\n---\ntitle: #{form_dict['title']}\nplaywright: #{form_dict['playwright']}\nseason: ??? (#{form_dict['type']})\nseason_sort: ??\nperiod: ??\nvenue:\n  - #{form_dict['venue']}\ndate_start: #{form_dict['date_start_year']}-#{form_dict['date_start_month']}-#{form_dict['date_start_day']}\ndate_end: #{form_dict['date_end_year']}-#{form_dict['date_end_month']}-#{form_dict['date_end_day']}\n\ncast:\n  - role:\n    name:\n\ncrew:\n  - role: Director\n    name:\n  - role: Producer\n    name:\n\ncomment: Details from #{form_dict['name']} (#{form_dict['graduation']})\npublished: true\n---\n\n#{form_dict['synopsis']}\n```\n\"\"\"\n\n    postData = {\n      'title': form_dict['title'],\n      'message': message,\n      'name': ''\n      'page_url': '/collect/show/'\n    }\n\n    report = new ReportModel\n      title: form_dict['title']\n      message: message,\n      name: ''\n      page_url: '/collect/show/'\n      url: $(this).attr 'action'\n\n    report.save\n      success: (data) ->\n        Turbolinks.visit('/collect/show/thanks/')\n      error: (data) ->\n        enableCollectForm()\n\n    disableCollectForm()\n\n  $(\"#collect-person-form\").submit (e) ->\n    e.preventDefault()\n\n    form_data = $(this).serializeArray()\n    form_dict = {}\n\n    form_data.forEach (x) ->\n      form_dict[x['name']] = x['value'].replace(/[^\\x00-\\x7F]/g, \"\");\n\n    form_data_computed =\n      'contact_allowed_yn': if form_dict['contact_allowed'] == 'on' then 'Yes' else 'No'\n      'contact_allowed_tf': if form_dict['contact_allowed'] == 'on' then 'true' else 'false'\n\n    career_choices = []\n    career_choices_formatted = \"\"\n    career_choices_yaml = \"\"\n    $('.career-choice').each (x) ->\n      if this.checked\n        career_choices.push( $(this).attr('name') )\n        career_choices_formatted += $(this).attr('name') + \", \"\n        career_choices_yaml += \"  - \" + $(this).attr('name') + \"\\n\"\n\n    message = \"\"\"# 'Submit an alumni bio' form submission\n\nField | Data\n----- | ----\nName | #{form_dict['name']}\nGrad Year | #{form_dict['graduation']}\nCourse | #{form_dict['course']}\n\n## Bio1 (Time at theatre)\n\n#{form_dict['bio1']}\n\n## Bio2 (Post-graduation)\n\n#{form_dict['bio2']}\n\nField | Data\n------| ----\nChecked careers | #{career_choices_formatted}\nOther careers | #{form_dict['career-other']}\n\n## Links\n\n#{form_dict['links']}\n\n## Shows\n\n#{form_dict['shows']}\n\n## Committees\n\n#{form_dict['committees']}\n\n## Awards\n\n#{form_dict['awards']}\n\n## Contact Preferences\n\nAre we allowed to facilitate contact to this alumnus? **#{form_data_computed['contact_allowed_yn']}**\n\n## Attempted File Generation\n\n```\n---\ntitle: #{form_dict['name']}\ncourse:\n  - #{form_dict['course']}\ngraduated: #{form_dict['graduation']}\ncontact_allowed: #{form_data_computed['contact_allowed_tf']}\ncareers:\n#{career_choices_yaml}\n#{form_dict['career-other']}\nlinks: *fill me out\n#{form_dict['links']}\naward: *fill me out\n#{form_dict['awards']}\n---\n\n#{form_dict['bio1']}\n\n#{form_dict['bio2']}\n\n```\n\"\"\"\n\n    window.message = message\n\n    report = new ReportModel\n      title: form_dict['name'] + \" bio submission\"\n      message: message,\n      name: ''\n      page_url: '/collect/person/'\n      url: $(this).attr 'action'\n\n    report.save\n      success: (data) ->\n        Turbolinks.visit('/collect/person/thanks/')\n      error: (data) ->\n        enableCollectForm()\n\n    disableCollectForm()\n\nPEOPLE_FEED = \"/feeds/people-collect.json\"\nTEMPLATE_DATA = \"#collect-template-list\"\n\ncollectPersonFormSetup = ->\n  collectBindEvents()\n  path = getUrlParameter('name')\n  if path and path.length > 0\n    $.get PEOPLE_FEED, (data) ->\n      if path of data # (path in data)\n        $('[data-have-details-show]').show()\n        $('[data-have-details-style]').addClass('collect-has-data')\n\n        $('.collect-field-name').val data[path].name\n        $('.collect-field-graduation').val data[path].graduated\n        $('.collect-field-course').val data[path].course\n        $('.collect-field-bio1').val data[path].bio\n\n        template = _.template $(TEMPLATE_DATA).html()\n        for item in data[path].shows\n          $('[data-have-details-shows-hide]').hide()\n          $(\"#collect-shows .collect-person-data\").append template\n            item: item\n\n        for item in data[path].committees\n          $('[data-have-details-committees-hide]').hide()\n          $(\"#collect-committees .collect-person-data\").append template\n            item: item\n\n    , 'json'\n\ndisableCollectForm = ->\n  $('.collect-submit').attr(\"disabled\", true)\n  $('.collect-submit').addClass('disabled')\n  $('.collect-submit').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i>')\n\n\nenableCollectForm = ->\n  $('.collect-submit').attr(\"disabled\", false)\n  $('.collect-submit').removeClass('disabled')\n  $('.collect-submit').html('Try Again')\n\n# Setup\n\ndocument.addEventListener 'turbolinks:load', ->\n  if $('body').hasClass 'collect-person-form'\n    collectPersonFormSetup()\n","# Needs to be window as used in third party script\nwindow.GITHUB_ISSUES_USER = \"newtheatre\"\nwindow.GITHUB_ISSUES_REPO = \"history-project\"\n\ndelay = (ms, func) -> setTimeout func, ms\n\ngetUrlParameter = (name) ->\n  match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search)\n  match and decodeURIComponent(match[1].replace(/\\+/g, ' '))\n\ndebounce = (fn) ->\n  timeout = undefined\n  ->\n    args = Array::slice.call(arguments)\n    ctx = this\n    clearTimeout timeout\n    timeout = setTimeout((->\n      fn.apply ctx, args\n      return\n    ), 40)\n\nisMobile = ->\n  $('#nthpMobileDetect').css('display') == 'block'\n\nwindow.im = isMobile","bindKeys = ->\n  Mousetrap.bind 'left', ->\n    if jekyll_page_previous? and not window.disable_keyboard_nav\n      Turbolinks.visit(jekyll_page_previous)\n\n  Mousetrap.bind 'right', ->\n    if jekyll_page_next? and not window.disable_keyboard_nav\n      Turbolinks.visit(jekyll_page_next)\n\n  Mousetrap.bind 'e d i t o r', ->\n    if localStorage.debug_mode is \"yes\"\n      # Disable\n      localStorage.debug_mode = \"no\"\n      $('[data-debug-toggle]').hide()\n    else\n      # Enable\n      localStorage.debug_mode = \"yes\"\n      $('[data-debug-toggle]').show()\n\nwindow.disable_keyboard_nav = false\n\ndocument.addEventListener 'DOMContentLoaded', ->\n  # DO NOT DO ON EVERY TURBONAV\n  bindKeys()\n\ndocument.addEventListener 'turbolinks:load', ->\n  if localStorage.debug_mode is \"yes\"\n    $('[data-debug-toggle]').show()\n\ndocument.addEventListener 'turbolinks:visit', ->\n  window.jekyll_page_up = null\n  window.jekyll_page_previous = null\n  window.jekyll_page_next = null\n","class LightboxGallery\n  constructor: (galleryEm) ->\n    @galleryEm = galleryEm\n    @galleryLinks = galleryEm.querySelectorAll('.lightbox-link')\n\n    for link in @galleryLinks\n      link.addEventListener(\"click\", @imageClick)\n\n  imageClick: (ev) =>\n    ev.preventDefault()\n    ev.srcElement.blur()\n    # Get image index in gallery\n    i = @getLinkIndex ev.srcElement.parentElement\n\n    @lightbox = new Lightbox(@, i)\n    window.currentLightbox = @lightbox\n\n  getLinkIndex: (elem) ->\n    # Given a link return it's index in the galleryLinks array\n    for link, i in @galleryLinks\n      if elem == link\n        return i\n\n  deleteLightbox: =>\n    delete @lightbox\n\nclass Lightbox\n  constructor: (lightboxGallery, i) ->\n    @lightboxGallery = lightboxGallery\n    @i = i\n\n    # Blur page\n    @blur = document.getElementById('lightbox-blur')\n    @blur.classList.add('lightbox-blur--show')\n    # Click on blue to close lightbox\n    @blur.addEventListener('click', @close)\n\n    # Add lightbox\n    @addElement()\n    @changeImage(i)\n\n    # Keyboard bindings\n    Mousetrap.unbind('left')\n    Mousetrap.bind('left', @prevImage)\n    Mousetrap.unbind('right')\n    Mousetrap.bind('right', @nextImage)\n    Mousetrap.bind('esc', @close)\n    # Weird cases where unbinding global not working, extra safety\n    window.disable_keyboard_nav = true\n\n    # Freeze scrolling\n    @scrollTop = $(document).scrollTop()\n    document.body.style.position = \"fixed\"\n    document.body.style.top = \"-#{@scrollTop}px\"\n\n  addElement: ->\n    @lb = document.createElement('div')\n    @lb.classList.add('lightbox-box')\n    @lb.innerHTML = \"\"\"\n    <div class=\"lightbox-box__inner\">\n      <div title=\"Previous\" class=\"lightbox-box__prev\">\n        <i class=\"ion-chevron-left\"></i>\n      </div>\n      <div title=\"Next\" class=\"lightbox-box__next\">\n        <i class=\"ion-chevron-right\"></i>\n      </div>\n      <div title=\"Close\" class=\"lightbox-box__close\">\n        <i class=\"ion-close-circled\"></i>\n      </div>\n      <div class=\"lightbox-box__load\">\n        <i class=\"ion-load-c\"></i>\n      </div>\n      <div class=\"lightbox-box__content\">\n\n      </div>\n    </div>\n    \"\"\"\n    document.body.appendChild(@lb)\n\n    prevEl = @lb.querySelector('.lightbox-box__prev')\n    nextEl = @lb.querySelector('.lightbox-box__next')\n    closeEl = @lb.querySelector('.lightbox-box__close')\n\n    prevEl.addEventListener('click', @prevImage)\n    nextEl.addEventListener('click', @nextImage)\n    closeEl.addEventListener('click', @close)\n\n    # Save ref to load spinner\n    @loadSpinnerEl = @lb.querySelector('.lightbox-box__load')\n\n    # Image or video goes in here\n    @contentEl = @lb.querySelector('.lightbox-box__content')\n    @imageEl = null\n    @videoEl = null\n\n    # Remove L&R if single image\n    if @lightboxGallery.galleryLinks.length == 1\n      prevEl.remove()\n      nextEl.remove()\n\n  nextImage: =>\n    if (@i + 1) < @lightboxGallery.galleryLinks.length\n      @changeImage(@i + 1)\n    else\n      # Wrap around\n      @changeImage(0)\n\n  prevImage: =>\n    if (@i - 1) >= 0\n      @changeImage(@i - 1)\n    else\n      # Loop around\n      @changeImage(@lightboxGallery.galleryLinks.length - 1)\n\n  setupImage: ->\n    # Create image element to use\n    @contentEl.innerHTML = \"<img class=\\\"lightbox-box__image\\\" src=\\\"\\\" alt=\\\"\\\" />\"\n    @videoEl = null\n    @imageEl = @contentEl.querySelector('.lightbox-box__image')\n    # Add load complete event handler\n    @imageEl.addEventListener('load', @imageLoaded)\n\n  imageLoaded: (ev) =>\n    # Image load has complete, hide spinner and fade in image\n    @loadSpinnerEl.classList.remove('lightbox-box__load--show')\n    @imageEl.classList.remove('lightbox-box__image--load')\n\n  setupVideo: (src) ->\n    # Create video element to use\n    @contentEl.innerHTML = \"\"\"<video class=\"lightbox-box__video lightbox-box__video--load\" controls autoplay>\n      <source src=\"#{src}\" type=\"video/mp4\" />\n    </video>\"\"\"\n    @imageEl = null\n    @videoEl = @contentEl.querySelector('.lightbox-box__video')\n    @videoEl.addEventListener('playing', @videoLoaded)\n\n  videoLoaded: (ev) =>\n    # Video load has complete, hide spinner and fade in image\n    @loadSpinnerEl.classList.remove('lightbox-box__load--show')\n    @videoEl.classList.remove('lightbox-box__video--load')\n    ev.target.removeEventListener(ev.type, arguments.callee)\n\n  changeImage: (i) ->\n    @loadSpinnerEl.classList.add('lightbox-box__load--show')\n    switch @lightboxGallery.galleryLinks[i].dataset.type\n      when \"image\"\n        if not @imageEl then @setupImage()\n        @imageEl.classList.add('lightbox-box__image--load')\n        @imageEl.src = @lightboxGallery.galleryLinks[i].href\n      when \"video\"\n        @setupVideo(@lightboxGallery.galleryLinks[i].href)\n      else console.error('Invalid lightbox gallery type')\n    @i = i\n\n  close: =>\n    # Unfreeze scrolling\n    document.body.style.position = \"static\"\n    $(document).scrollTop(@scrollTop)\n\n    # Remove blur\n    @blur.classList.remove('lightbox-blur--show')\n    @blur.removeEventListener('click', @close)\n    # Remove lightbox\n    document.body.removeChild(@lb)\n    # Remove ref for this lightbox from gallery\n    @lightboxGallery.deleteLightbox()\n    # Rebind page arrow keys, remove esc listener\n    bindKeys()\n    Mousetrap.unbind('esc')\n    window.disable_keyboard_nav = false\n\n\ndocument.addEventListener 'turbolinks:load', ->\n  groups = document.querySelectorAll('.lightbox-group')\n\n  # Initialise array, will remove old lightboxes on turbolink navigation\n  lbs = []\n  for group in groups\n    lbs.push new LightboxGallery(group)\n\n  window.lbs = lbs\n\n","class ReportModel\n  constructor: (opts) ->\n    @title = opts.title\n    @page_url = opts.page_url\n    @message = opts.message\n    @name = opts.name\n    @url = opts.url\n\n  buildJSON: =>\n    JSON.stringify\n      title: @title\n      page_url: @page_url\n      message: @message\n      name: @name\n\n  save: (opts) ->\n    FORM_URL = @url\n    data = @buildJSON()\n    window.reportModelData = data\n    $.ajax\n      url : FORM_URL\n      type: \"POST\"\n      data : data\n      success: (data, textStatus, jqXHR) ->\n        if data.status is \"success\"\n          opts.success(data)\n        else\n          alert('There was a problem with the data your provided')\n          opts.error()\n      error: (jqXHR, textStatus, errorThrown) ->\n        alert('Oops, something went wrong')\n        error()\n\ndisableReportForm = ->\n  $('.report-submit').attr(\"disabled\", true)\n  $('.report-submit').addClass('disabled')\n  $('.report-submit').html('<i class=\"fa fa-circle-o-notch fa-spin\"></i>')\n\n\nenableReportForm = ->\n  $('.report-submit').attr(\"disabled\", false)\n  $('.report-submit').removeClass('disabled')\n  $('.report-submit').html('Try Again')\n\nreportThanks = (url) ->\n  template = _.template $('#report-success-template').html()\n  $('#report-modal-content').html template('url': url)\n\nfrozenScrollTop = null\n\nfreezeScrolling = () ->\n  # Freeze scrolling\n  frozenScrollTop = $(document).scrollTop()\n  document.body.style.position = \"fixed\"\n  document.body.style.top = \"-#{frozenScrollTop}px\"\n\nunfreezeScrolling = () ->\n  # Unfreeze scrolling\n  document.body.style.position = \"static\"\n  $(document).scrollTop(frozenScrollTop)\n\ndocument.addEventListener 'turbolinks:load', ->\n  $('#report-this-page').click (e) ->\n    e.preventDefault()\n    freezeScrolling()\n    $('#report').addClass 'report-show'\n  $('[data-report-close]').click (e) ->\n    e.preventDefault()\n    unfreezeScrolling()\n    $('#report').removeClass 'report-show'\n    $('#improve').removeClass 'report-show'\n\n  $('#improve-this-page').click (e) ->\n    if localStorage.debug_mode isnt \"yes\"\n      e.preventDefault()\n      freezeScrolling()\n      $('#improve').addClass 'report-show'\n  $('[data-improve-close]').click (e) ->\n    e.preventDefault()\n    unfreezeScrolling()\n    $('#improve').removeClass 'report-show'\n\n  $('[data-report-this-page]').click (e) ->\n    e.preventDefault()\n    freezeScrolling()\n    $('#improve').removeClass 'report-show'\n    $('#report').addClass 'report-show'\n\n  $(\"#report-issue-form\").submit (e) ->\n    e.preventDefault()\n\n    report = new ReportModel\n      title: $(\"#report-title\", this).val()\n      page_url: $(\"#report-page_url\", this).val()\n      message: $(\"#report-message\", this).val()\n      name: $(\"#report-name\", this).val()\n      url: $(this).attr 'action'\n\n    report.save\n      success: (data) ->\n        reportThanks(data.url)\n      error: (data) ->\n        enableReportForm()\n\n    disableReportForm()\n","# If search page\n\nINDEX_URL = '/feeds/search_index.json'\nREVERSE_INDEX_URL = '/feeds/search_index_reverse.json'\n\nindexReady = ->\n  # Must wait for this function call before running searches\n  configureWindow()\n\nconfigureWindow = ->\n  sView = new SearchResultView\n\n  # DEBUG GLOBALS\n  window.sView = sView\n  # window.reverse_index = reverse_index\n  # window.index = index\n\n  # Search based on url param from previous page\n  urlQ = getUrlParameter('q')\n  if urlQ != null\n    sView.search urlQ\n    $('#q').val urlQ\n  else\n    sView.renderBlank()\n\n  # Focus to search field\n  $('#q').focus()\n\n  # Bind to keyup events on the search box\n  $('#q').keyup debounce ->\n    if $(this).val().length < 2\n      return sView.renderBlank()\n\n    query = $(this).val()\n    sView.search(query)\n\nindex = new Object\nreverse_index = new Object\n\nloadIndex = ->\n  # Populate the lunr index with page data\n  console.time 'loadIndex'\n  $.get INDEX_URL, (data) ->\n    index = lunr.Index.load(data)\n    $.get REVERSE_INDEX_URL, (data) ->\n      reverse_index = data\n      # Search is ready\n      indexReady()\n    , 'json'\n  , 'json'\n  console.timeEnd 'loadIndex'\n\ndoSearch = (query) ->\n  # The actual search code. Take query, return useful array.\n  lunr_results = index.search(query)\n\n  results = new Array\n  lunr_results.forEach (item) ->\n    results.push reverse_index[ item['ref'] ]\n\n  return results\n\nwindow.doSearch = doSearch\n\nclass SearchResultView\n  TEMPLATE_RESULT = '#search-result'\n  TEMPLATE_EMPTY = '#search-message-empty'\n  RENDER_TO = '[data-search-results]'\n\n  getSingleTemplate: ->\n    _.template $(TEMPLATE_RESULT).html()\n\n  search: (query) ->\n    @query = query\n    @render()\n\n  render: ->\n    results = doSearch(@query)\n\n    if results.length > 0\n      @renderResults(results)\n    else\n      @renderEmpty()\n\n  renderResults: (results) ->\n    singleTemplate = @getSingleTemplate()\n    results_html = []\n    results.forEach (result) ->\n      results_html.push singleTemplate\n        item: result\n\n    $(RENDER_TO).html results_html\n\n  renderEmpty: ->\n    template = _.template $(TEMPLATE_EMPTY).html()\n    html = template\n      query: @query\n    $(RENDER_TO).html html\n\n  renderBlank: ->\n    $(RENDER_TO).html '<!-- BLANK -->'\n\n# Setup\ndocument.addEventListener 'turbolinks:load', ->\n  if $('body').hasClass 'search'\n    loadIndex()\n    urlQ = getUrlParameter('q')\n    if urlQ != null\n      $('#q').val urlQ\n",null,"document.addEventListener 'turbolinks:load', ->\n  # Mobile search box\n  $('#site-search-show').click ->\n    $('#site-search').addClass('elem-show')\n    $('#site-search-bg').removeClass('elem-hidden')\n    $('#q').focus()\n  $('#site-search-bg').click ->\n    $('#site-search').removeClass('elem-show')\n    $('#site-search-bg').addClass('elem-hidden')\n","document.addEventListener 'turbolinks:load', ->\n  $('.js-lettering').lettering()\n"]}